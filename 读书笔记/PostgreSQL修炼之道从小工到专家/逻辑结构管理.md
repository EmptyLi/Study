- 数据库
> 一个PostgreSQL数据库服务下可以管理多个数据库，当应用连接到一个数据库时，一般只能访问这个数据库中数据，而不能访问其他数据库中的内容

- 表、索引
> 一个数据库中有很多表、索引。一般，在PostgreSQL中表的术语为"Relation"，而在其他数据库中则叫"Table"

- 数据行
> 每张表有很多行数据。在PostgreSQL中行的术语一般为"Tuple"，而在其他数据库中则叫"Row"

**在PostgreSQL中，一个数据库服务(实例)下可以有多个数据库，而一个数据库不能属于多个实例，这与Oracle数据库不同，在Oracle数据库中，一个实例只能有一个数据库，但一个数据库可以在多个实例中**

## 6.2 数据库基本操作
### 6.2.1 创建数据库
```sql
create database databasename
   [[ with ]
   -- 指定创建的数据库属于哪个用户。如果不指定，创建的数据库就属于当前执行命令的用户
    [ owner [ = ] user_name]
    -- 从哪个模板创建数据库。如果不指定，将使用默认模板数据库 template1
    [ template [ = ] template ]
    -- 创建新数据库使用的字符编码
    [ encoding [ = ] encoding ]
    [ lc_collate [ = ] lc_collate ]
    [ lc_ctype [ = ] lc_type ]
    -- 指定和新数据库关联的表空间名字
    [ tablespace [ = ] tablespace ]
    -- 数据库可以接受多少并发的连接。默认为：-1，表示没有限制
    [ connection limit [ = ] connlimit ]]
```
- encoding
```sql
create database testdb01 encoding 'LATIN1' template template0;
```
> 编码和区域设置必须与模板数据库的相匹配，如果模板数据库中包含了新建的数据库之编码不匹配的数据，或者包含了排序受lc_collate和lc_ctype影响的索引，那么复制这些数据将会导致数据库被新设置破坏。template0 公认不包含任何会受字符集编码或排序影响的数据或索引，故可以作为创建任意字符集数据库的模板。在日常使用中，PostgreSQL数据库服务端并不支持通常的汉字字符集 "GBK"，"GB18030"，所以一般都是使用"UTF8"字符集来支持中文。

### 6.2.2 修改数据库
```sql
alter database name [ [ with ] option [ ... ]]

-- 设置连接数
postgres=# alter database test01 connection limit -1;
ALTER DATABASE
postgres=# alter database test01 connection limit 100;
ALTER DATABASE
postgres=# alter database test01 rename to testdb;
ALTER DATABASE
postgres=# \l
                                    List of databases
     Name      |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges
---------------+----------+----------+-------------+-------------+-----------------------
 cs_master_stg | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 postgres      | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 template0     | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |          |          |             |             | postgres=CTc/postgres
 template1     | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |          |          |             |             | postgres=CTc/postgres
 testdb        | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
(5 rows)

-- 设置用户
postgres=# alter database testdb owner to cs_master_stg;
ERROR:  role "cs_master_stg" does not exist
postgres=# create user cs_master_stg password 'abc123';
CREATE ROLE
postgres=# alter database testdb owner to cs_master_stg;
ALTER DATABASE
postgres=# \l
                                      List of databases
     Name      |     Owner     | Encoding |   Collate   |    Ctype    |   Access privileges
---------------+---------------+----------+-------------+-------------+-----------------------
 cs_master_stg | postgres      | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 postgres      | postgres      | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 template0     | postgres      | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |               |          |             |             | postgres=CTc/postgres
 template1     | postgres      | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |               |          |             |             | postgres=CTc/postgres
 testdb        | cs_master_stg | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
(5 rows)

--
alter database name set tablespace new_tablespace;

--
alter database name set configuration_parameter {to | =} {value | default};

postgres=# alter database testdb set enable_indexscan to off;
ALTER DATABASE


--
alter database name set configuration_parameter from current;

--
alter database name reset configuration_parameter;

--
alter database name reset all;
```

### 6.2.3 删除数据库
```sql
drop database [ if exists ] name;
```

> 不能在事务块中删除数据库， 但是可以在事务块中修改数据库。
```sql
postgres=# begin;
BEGIN
postgres=# drop database testdb;
ERROR:  DROP DATABASE cannot run inside a transaction block
postgres=# rollback;
ROLLBACK

postgres=# begin;
BEGIN
postgres=# alter database cs_master_stg owner to cs_master_stg;
ALTER DATABASE
postgres=# end;
COMMIT
postgres=# \l
                                      List of databases
     Name      |     Owner     | Encoding |   Collate   |    Ctype    |   Access privileges
---------------+---------------+----------+-------------+-------------+-----------------------
 cs_master_stg | cs_master_stg | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 postgres      | postgres      | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 template0     | postgres      | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |               |          |             |             | postgres=CTc/postgres
 template1     | postgres      | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
               |               |          |             |             | postgres=CTc/postgres
 testdb        | cs_master_stg | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
(5 rows)

```

### 6.3.1 模式的定义
> 模式(schema)是数据库的一个概念，可以将其理解为一个命名空间或目录。不同的模式下可以有相同名称的表、函数等对象且互相不冲突。提出模式的概念是为了便于管理，只要有权限，每个模式(schema)的对象可以互相调用。在PostgreSQL中，一个数据库包含一个或多个模式，模式中又包含了表、函数及操作符等数据库对象。在PostgreSQL中，不能同时访问不同数据库中的对象，当要访问另一个数据库中的表或其他对象时，需要重新连接到这个新的数据库，而模式没有此限制。一个用户在连接到一个数据库后，就可以同时访问这个数据库中多个模式的对象。从这个特性来说，PostgreSQL中模式的概念与MySQL中Database的概念是等同的。在MySQL中可以同时访问多个Database中的对象，就与在PostgreSQL中可以同时访问多个schema中的对象是一样的。在Oracle数据库中，一个用户就对应一个schema。
