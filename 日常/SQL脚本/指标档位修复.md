```sql
DECLARE
  TYPE TP_REC IS TABLE OF TEMP_MODIFY_DEFINE%ROWTYPE;
  V_REC             TP_REC;
  V_STMT_STR_UPDATE VARCHAR2(3000);
  V_STMT_STR_SELECT VARCHAR2(3000);
  V_EXPOSURE_SID    CLIENT_EXPOSURE.EXPOSURE_SID%TYPE;
BEGIN
  execute immediate 'truncate table temp_modify_define_bak';
  SELECT *
    BULK COLLECT
    INTO V_REC
    FROM TEMP_MODIFY_DEFINE
   ORDER BY MODIFY_CLASS;

  FOR I IN 1 .. V_REC.COUNT LOOP
    SELECT EXPOSURE_SID
      INTO V_EXPOSURE_SID
      FROM CLIENT_EXPOSURE
     WHERE ISDEL = 0
       AND EXPOSURE = V_REC(I).EXPOSURE_SID
       AND CLIENT_ID = 5;
    V_STMT_STR_UPDATE := ' update ' || V_REC(I).MODIFY_CLASS || ' set ' || V_REC(I)
                        .MODIFY_TYPE || ' = ''' || V_REC(I).MODITY_VALUE || '''' ||
                         ' , updt_dt = systimestamp where 1 = 1 ';
    V_STMT_STR_SELECT := 'select ''' || V_REC(I).modify_class || ''',''' || V_REC(I)
                        .modify_item || ''',' || V_REC(I).MODIFY_TYPE ||
                         ',''' || V_REC(i).flag || ''',''' || V_EXPOSURE_SID ||
                         ''', count(*), systimestamp , '''|| V_REC(I).MODIFY_TYPE ||''' from ' || V_REC(I)
                        .MODIFY_CLASS || ' where 1 = 1 ';
    CASE
      WHEN UPPER(V_REC(I).MODIFY_CLASS) = UPPER('factor') THEN
        V_STMT_STR_UPDATE := V_STMT_STR_UPDATE || ' and factor_cd = ''' || V_REC(I)
                            .MODIFY_ITEM || ''' and 1 = 1';

        V_STMT_STR_SELECT := V_STMT_STR_SELECT || ' and factor_cd = ''' || V_REC(I)
                            .MODIFY_ITEM || ''' and 1 = 1';
      WHEN UPPER(V_REC(I).MODIFY_CLASS) = UPPER('element') THEN
        V_STMT_STR_UPDATE := V_STMT_STR_UPDATE || ' and element_cd = ''' || V_REC(I)
                            .MODIFY_ITEM || '''';

        V_STMT_STR_SELECT := V_STMT_STR_SELECT || ' and element_cd = ''' || V_REC(I)
                            .MODIFY_ITEM || '''';
      WHEN UPPER(V_REC(I).MODIFY_CLASS) = UPPER('factor_option') THEN
        V_STMT_STR_UPDATE := V_STMT_STR_UPDATE || ' and factor_cd = ''' || V_REC(I)
                            .MODIFY_ITEM || ''' ' || 'and client_id = 5  and option_num = ''' || V_REC(I).FLAG || '''' ||
                             ' and exposure_sid = ''' || V_EXPOSURE_SID || '''';

        V_STMT_STR_SELECT := V_STMT_STR_SELECT || ' and factor_cd = ''' || V_REC(I)
                            .MODIFY_ITEM || ''' ' ||
                             ' and client_id = 5 and option_num = ''' || V_REC(I).FLAG || '''' ||
                             ' and exposure_sid = ''' || V_EXPOSURE_SID || '''';
    END CASE;

    V_STMT_STR_SELECT := V_STMT_STR_SELECT || ' group by ' || V_REC(I)
                        .MODIFY_TYPE ;
    v_stmt_str_select := 'insert into temp_modify_define_bak(modify_class, modify_item, modity_value,flag,exposure_sid, cnt, updt_dt, modify_type)' ||
                         v_stmt_str_select || ';';

    DBMS_OUTPUT.PUT_LINE(V_STMT_STR_select );
  END LOOP;
EXCEPTION
  WHEN OTHERS THEN
    DBMS_OUTPUT.PUT_LINE(SQLCODE || SQLERRM);
END;

```
